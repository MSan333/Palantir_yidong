在 Palantir Foundry 的 **Pipeline Builder** 中，图像分类是一种集成多模态模型（Multimodal Models）的工作流，允许用户通过大语言模型（LLM）对图像内容进行自动化标注和识别 [1, 2]。

以下是实现图像分类的详细步骤和核心机制：

### 1. 数据准备与媒体集（Media Sets）
*   **上传数据：** 首先需要将本地图像（如 JPEG 格式）上传到 Foundry 中 [3]。
*   **创建媒体集：** 在上传时，必须选择将其保存为**媒体集（Media Set）**，这是 Foundry 存储非结构化数据（如图片、PDF）的专用格式 [3, 4]。媒体集允许在不复制原始文件的情况下，在整个平台中引用媒体资源 [2]。

### 2. 媒体集到表格的转换
*   **节点转换：** 在 Pipeline Builder 中，由于原始媒体集无法直接进行逻辑运算，必须使用 **"Convert media set to table rows"** 转换插件 [3]。
*   **生成列：** 转换后，媒体集会变为包含以下关键列的表格：
    *   **Path：** 原始文件名 [3]。
    *   **Media Reference：** 指向媒体文件的特殊类型指针，这是后续模型进行图像识别的关键输入列 [2, 3]。
    *   **Media Item RID：** 媒体项的唯一资源标识符 [3]。

### 3. 应用大语言模型（Use LLM）
*   **转换类型：** 选择 **"Use LLM"** 转换，该功能允许将多模态模型逐行应用于数据集 [2]。
*   **分类模板（Classification Template）：** 系统提供了预设的分类模板，用户只需配置以下参数即可快速构建提示词（Prompt）[5]：
    *   **Multiplicity（多样性）：** 定义目标分类是单选还是多选 [5]。
    *   **Context（背景）：** 提供业务上下文（如“航运分析”）[5]。
    *   **Categories（类别）：** 定义分类标签（例如“有货物”或“无货物”）[5]。
    *   **Input Column（输入列）：** 选择包含图像信息的 **Media Reference** 列 [5]。

### 4. 提示词微调与模型选择
*   **模型配置：** 用户可以选择高性能模型（如 **GPT-4o**），并调整温度（Temperature）和最大 Token 数等参数 [5, 6]。
*   **自定义说明：** 用户可以微调系统生成的提示词。例如，要求模型在分类的同时，用不超过 5 个词提供简短的解释（Explanation），以增加结果的可解释性 [6]。

### 5. 试运行与验证（Trial Run）
*   **抽样测试：** 在正式部署前，Pipeline Builder 提供 **"Trial Run"** 界面。用户可以选定几行数据（如 8-10 张图片）运行模型 [7]。
*   **结果对比：** 用户可以实时查看到分类结果和模型生成的解释。例如，模型能识别出某张图片是“虚构的航天器”而非真实的货船，或者通过观测船只吃水深度来判断其是否载有货物 [7]。

### 6. 输出与部署
*   **发布数据集：** 完成配置后，将输出节点添加为新的数据集（如 "Classified Vessels"）并进行部署 [4]。
*   **可视化效果：** 在生成的最终数据集中，由于保留了 **Media Reference** 属性，用户在查看表格数据时可以直接看到图像的**缩略图**及其对应的分类结果 [4]。

通过这种方式，Pipeline Builder 将复杂的计算机视觉任务简化为了直观的**点选配置过程**，使非技术用户也能利用 AI 能力大规模处理图像数据 [1, 4]。
