在 Palantir Foundry 的 **AIP Logic** 中，**对象查询（Object Queries）** 是一种核心工具，它允许大语言模型（LLM）通过编写并执行针对本体（Ontology）后端的数据查询，直接获取、过滤、聚合和排序结构化数据 [1, 2]。

以下是关于 AIP Logic 中对象查询工具的详细介绍：

### 1. 核心功能与作用
*   **数据落地（Grounding）：** LLM 往往会生成虚假信息。对象查询工具强制模型基于真实的本体数据生成回答，而不是凭空捏造 [3, 4]。
*   **类似于 SQL 的能力：** 该工具使 LLM 能够执行类似于 SQL 的操作，包括对对象属性的过滤、数值计算（如求和、平均值）、排序以及对链接对象（Linked Objects）的导航 [1, 5, 6]。
*   **思维链推理（Chain of Thought）：** 在执行查询时，模型会展示其推理过程。例如，“首先我将查询‘ride’对象类型，以查找描述中包含‘water’一词的项目” [7, 8]。

### 2. 配置与调用流程
要在 AIP Logic 中启用此功能，开发者需遵循以下步骤：
1.  **添加工具：** 在 **“Use LLM”** 逻辑块中，点击 **“Add tool”** 并选择 **“Query objects”** [2, 4]。
2.  **选择对象：** 搜索并添加特定的本体对象类型。开发者可以配置模型有权访问哪些具体属性或链接关系 [2, 4]。
3.  **提示词驱动：** 在系统提示词（System Prompt）中指示模型使用该工具。例如：“你是一名专家，请使用给你的工具回答用户关于订单性能的问题” [2]。

### 3. 两种调用模式（Modes）
Foundry 提供了两种工具调用机制，它们在性能和可靠性上有显著差异：

*   **提示词驱动工具调用（Prompted Tool Calling - 旧方式）：**
    *   **原理：** 系统向模型发送一段冗长的模板指令，教导它如何编写查询指令，然后由 Foundry 平台解析这些文本指令 [6, 9]。
    *   **缺点：** 响应速度较慢，Token 开销大，且容易因为模型生成的格式微差导致解析失败 [10]。
*   **原生工具调用（Native Tool Calling - 新推荐方式）：**
    *   **原理：** LLM 直接输出结构化指令，这些指令能够可靠且并行地执行 [6, 10]。
    *   **优点：** 速度显著提升（例如从 5 秒减少到 3.9 秒），Token 成本更低，更适合生产环境 [10, 11]。

### 4. 利用本体元数据进行优化
LLM 在查询时的一个常见问题是它**能看到架构（Schema）但看不到具体数据值**。例如，用户搜索“US”的数据，但数据库中存储的是“USA”，模型可能会因为找不到匹配项而返回空结果 [12, 13]。

*   **优化技巧：** 在 **本体管理器（Ontology Manager）** 中，将该属性可能的取值列表（如所有的国家代码）粘贴到**属性描述（Property Description）**字段中 [14, 15]。
*   **效果：** AIP Logic 会将这些描述信息包含在提示词中，使模型能够自动识别出“US”等同于数据中的“USA”，从而提高查询的准确性 [15]。

### 5. 对象查询 vs. 语义搜索
开发者需要根据任务类型选择合适的工具：
*   **对象查询：** 适用于**结构化请求**。当用户的问题可以通过明确的过滤器、数学聚合（如“查询来自英国的总订单量”）或排序来回答时，应使用此工具 [1, 16]。
*   **语义搜索：** 适用于**非结构化文本内容**。当问题涉及“意义”而非明确的关键词匹配时（如“寻找能让人兴奋但不会眩晕的游乐设施”），语义搜索效果更好 [1, 5]。

通过灵活运用对象查询工具，AIP Logic 可以将大模型的推理能力与企业核心本体数据深度结合，构建出精准、可审计的 AI 工作流 [16, 17]。
