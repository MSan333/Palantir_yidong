**AIP Agents** 是 Palantir Foundry 中基于大语言模型（LLM）的智能代理，旨在为用户提供**基于聊天的交互式体验** [1, 2]。通过 **AIP Agent Studio**，开发者可以构建能够理解业务语境、查询本体数据、执行操作甚至具备跨会话记忆的专业 AI 助手 [1-3]。

以下是关于 AIP Agents 的详细介绍：

### 1. 核心构建单元：三种上下文 (Contexts)
要让 Agent 能够准确回答问题并执行任务，需要为其配置三种类型的上下文 [4]：

*   **应用状态 (Application State)：** 允许 Agent 从其部署的环境（如 Workshop 应用）中读取变量 [4-6]。例如，Agent 可以通过应用变量获取**当前用户的姓名或 ID**，从而实现个性化称呼或过滤数据 [7, 8]。
*   **检索上下文 (Retrieval Context)：** 无论消息内容如何，Agent 在回复时都会参考的背景知识 [4]。
    *   **文档上下文 (Document Context)：** 直接上传 PDF 语料库。这种方式较为临时，仅供该 Agent 使用 [9, 10]。
    *   **本体上下文 (Ontology Context)：** 使用本体中带有**嵌入属性 (Embedding Property)** 的对象类型 [9, 11]。这种方式建立的知识库可以被全组织复用，并能与其他结构化数据（如手册与设备的关系）建立关联 [12, 13]。
*   **工具 (Tools)：** Agent 在处理特定任务时可以主动调用的功能 [4, 14]。
    *   **Apply Action：** 允许 Agent **在本体中写入数据**，例如创建新的报修单或修改对象状态 [14-16]。
    *   **Object Query：** 允许 Agent 编写查询来搜索本体中的对象及其链接关系 [17, 18]。
    *   **Functions：** 调用发布的逻辑函数（如 TypeScript 函数）进行复杂计算 [14, 17]。

### 2. 关键功能特性
*   **记忆功能 (Memory)：** 通过将用户的偏好或历史输入保存到特定的“记忆对象”中，并结合检索上下文，Agent 可以实现**跨聊天会话的记忆**。例如，它能记住用户对沙拉配料的喜好并在下次推荐时自动应用 [3, 19, 20]。
*   **引用与溯源 (Citations)：** Agent 在基于文档或本体上下文回答问题时，会自动生成**引用链接** [21]。用户点击来源即可直接跳转到原始 PDF 的特定页面，确保 AI 的回答“植根于现实”且可验证 [22-24]。
*   **操作自动化：** 开发者可以配置 Agent 是**自动运行选定操作**，还是在执行前显示一个按钮供用户确认 [25-27]。
*   **推理透明度：** 在测试界面中，开发者可以查看 Agent 的**思维链 (Chain of Thought)**，了解其如何进行语义搜索、调用工具以及处理逻辑的详细步骤 [16, 28]。

### 3. Agent 类型
在创建时，用户可以选择两种类型的 Agent [22]：
*   **标准代理 (Standard Agent)：** 适用于大多数嵌入在 Workshop 应用中的业务工作流 [22, 29]。
*   **AIP 辅助代理 (AIP Assist Agent)：** 专门用于通过 AIP Assist 界面访问的代理 [22]。

### 4. 开发与部署流程
1.  **Studio 配置：** 在 AIP Agent Studio 中定义**系统提示词 (System Prompt)**，设定 Agent 的角色（如“飞行教练”或“科研助手”），配置所需的模型（如 GPT-4o）和上下文 [6, 30, 31]。
2.  **测试与优化：** 利用 Studio 内部的调试工具输入测试问题，观察 Agent 的推理过程，并根据反馈调整提示词或检索阈值 [28, 32]。
3.  **发布 (Publish)：** 完成配置后发布 Agent 版本 [33, 34]。
4.  **Workshop 集成：** 在 Workshop 应用程序中添加 **AIP Agent Interactive Widget**，并将其与发布好的 Agent 绑定 [34-36]。
5.  **变量映射：** 将 Workshop 中的变量（如对象集、用户信息）连接到 Agent 的“应用状态”输入参数上，使 Agent 能够响应应用内的实时状态 [35, 37, 38]。

### 5. 实际应用场景示例
*   **FAA 专家代理：** 基于《飞行员初级手册》提供关于 Carburetor Icing 或 PAVE 清单的专业解答 [2, 24]。
*   **科研助手：** 针对特定的化学报告（如草甘膦相关研究）提供简明扼要的总结，并准确指出信息出自哪份 PDF 的哪一页 [1, 28]。
*   **自动化工单处理：** 根据用户描述的突发状况（如“管道爆炸”）自动判断紧急程度（Critical），并在系统中创建相应的故障单 [16, 27]。
