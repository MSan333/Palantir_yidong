在 Palantir Foundry 的 AIP Agent Studio 中，**操作（Actions）** 是一种核心工具类型，允许 AI 代理不仅能回答问题，还能直接对**本体（Ontology）**进行写入、修改或删除操作，从而实现从“对话”到“执行”的转变 [1, 2]。

以下是关于 AIP Agent 中使用操作工具的详细介绍：

### 1. 核心功能与作用
*   **回写数据：** 与仅读取数据的“检索上下文”不同，操作工具使代理能够**在本体中创建新对象、修改现有对象或触发外部工作流**（如发送通知、调用 Webhooks）[2-4]。
*   **决策捕获：** 通过操作，团队可以捕获 AI 在对话过程中生成的决策（如自动生成报修单、保存用户偏好记忆），并将其持久化到数据基础层中 [5, 6]。

### 2. 构建与配置流程
要让 AIP Agent 使用操作，通常需要遵循以下三个主要步骤：

#### A. 准备本体基础
*   **定义对象与操作类型：** 首先必须在本体管理器（Ontology Manager）中存在对应的对象类型和**操作类型（Action Type）** [6]。例如，创建一个“报告问题（Reported Issue）”对象，并关联一个“创建问题”的操作 [7, 8]。
*   **开启编辑权限：** 必须在对象设置中勾选 **"Allow Edits"**，否则代理无法回写数据 [9, 10]。

#### B. 在 Agent Studio 中配置工具
*   **添加工具：** 在 Agent 配置界面的 **Tools** 模块下，选择 **Apply Action**，并搜索绑定已有的操作类型 [2, 4]。
*   **编写工具描述（Tool Description）：** 这是至关重要的一步，通过自然语言描述工具的用途，帮助大语言模型（LLM）判断**在什么样的情况下、为什么要调用该工具** [4]。
*   **参数映射：** 设置操作所需的参数。部分参数可以由模型根据用户对话内容自动提取（如“描述”、“严重程度”），部分则可以由应用状态（Application State）自动填充（如“用户 ID”）[11, 12]。

#### C. 提示词工程（Prompting）
*   **引用工具：** 在代理的**系统提示词（System Prompt）**中，通过输入正斜杠（`/`）引用该操作工具 [13, 14]。
*   **定义调用逻辑：** 开发者需明确说明调用时机。例如：“根据用户描述确定严重程度，然后使用 `/create_issue` 工具创建记录” [14]。
*   **严格约束：** 为了防止 AI 误操作，可以添加约束条件，如“仅当用户明确提及‘请记住’时才执行操作” [13, 15]。

### 3. 关键配置选项：执行模式
代理执行操作有两种主要的交互模式，由 **"Allow agent to automatically run the selected action"** 开关控制 [16]：
*   **手动确认（开关关闭）：** 代理会在对话框中显示一个**预览按钮**。用户点击该按钮并核对提取的参数（如描述、状态）后，手动点击“提交”才能正式应用修改 [17]。
*   **自动执行（开关开启）：** 代理在判断需要执行操作时，会直接在后台完成回写并通知用户执行结果，**无需用户额外点击按钮** [11, 16]。

### 4. 典型应用场景示例
*   **自动化工单处理：** 代理根据用户的故障描述（如“办公室水管爆裂”），自动推断严重程度为“紧急（Critical）”，并实时在系统中创建报修工单 [1, 17]。
*   **跨会话记忆（Memory）：** 当用户说“记住我不喜欢沙拉里的洋葱”时，代理调用“创建记忆对象”的操作，将此偏好保存。在未来的对话中，代理通过检索这些对象来提供个性化回复 [18, 19]。
*   **流程状态更新：** 代理在确认任务完成后，自动将对应的订单对象状态修改为“已分配”或“已完成” [20, 21]。

### 5. 调试与透明度
在测试 Agent 时，开发者可以查看其**思维链（Chain of Thought）** [1]。这能清晰展示代理如何分析用户意图、判断是否需要调用工具，以及它最终为操作参数填充了哪些具体数值 [14, 17]。
